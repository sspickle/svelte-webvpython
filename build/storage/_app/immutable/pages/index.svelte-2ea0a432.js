import{_ as J}from"../chunks/preload-helper-60cab3ee.js";import{S as Q,i as G,s as X,e as k,t as S,k as W,c as y,a as I,h as A,d as u,m as N,g as w,J as b,K as q,j as V,L as Y,b as P,M as Z,E as F,N as R,v as x,O as $}from"../chunks/index-3b1e7adb.js";import{s as M,p as B}from"../chunks/prefs-ed3737a1.js";import{w as ee,b as te}from"../chunks/paths-58176f9b.js";function oe(){return new Worker("/_app/immutable/assets/editor.worker.6369e042.js",{type:"module"})}function se(){return new Worker("/_app/immutable/assets/json.worker.cc26763b.js",{type:"module"})}function ie(){return new Worker("/_app/immutable/assets/css.worker.57c3cb89.js",{type:"module"})}function ne(){return new Worker("/_app/immutable/assets/html.worker.ae09e20d.js",{type:"module"})}function re(){return new Worker("/_app/immutable/assets/ts.worker.bcb033c8.js",{type:"module"})}const O=ee();function le(){gapi.auth2.getAuthInstance().signIn()}function ae(){gapi.auth2.getAuthInstance().signOut()}function H(d){if(d){const o=gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile();O.set({email:o.getEmail(),name:o.getName(),imageUrl:o.getImageUrl()})}else O.set(void 0)}const ue="https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.metadata https://www.googleapis.com/auth/drive";async function ce(){await gapi.client.init({apiKey:"AIzaSyDTqOsiHiEgvvNdt1AEiBnQA-siT25SrbA",clientId:"1055404475074-die17tdha84ak0u9d3fdvns2aqcvkfbp.apps.googleusercontent.com",scope:ue}),H(gapi.auth2.getAuthInstance().isSignedIn.get()),gapi.auth2.getAuthInstance().isSignedIn.listen(d=>H(d))}function z(d){let o,r,a,s,_,f,i,n,p,g,m;return{c(){o=k("button"),r=S("Save"),a=W(),s=k("span"),_=S("Currently editing: gid: "),f=S(d[0]),i=W(),n=k("span"),p=S(d[2])},l(t){o=y(t,"BUTTON",{});var h=I(o);r=A(h,"Save"),h.forEach(u),a=N(t),s=y(t,"SPAN",{});var E=I(s);_=A(E,"Currently editing: gid: "),f=A(E,d[0]),E.forEach(u),i=N(t),n=y(t,"SPAN",{});var C=I(n);p=A(C,d[2]),C.forEach(u)},m(t,h){w(t,o,h),b(o,r),w(t,a,h),w(t,s,h),b(s,_),b(s,f),w(t,i,h),w(t,n,h),b(n,p),g||(m=q(o,"click",d[5]),g=!0)},p(t,h){h&1&&V(f,t[0]),h&4&&V(p,t[2])},d(t){t&&u(o),t&&u(a),t&&u(s),t&&u(i),t&&u(n),g=!1,m()}}}function de(d){let o,r,a,s,_,f,i;return{c(){o=k("span"),r=S("No user"),a=W(),s=k("button"),_=S("Login")},l(n){o=y(n,"SPAN",{});var p=I(o);r=A(p,"No user"),p.forEach(u),a=N(n),s=y(n,"BUTTON",{});var g=I(s);_=A(g,"Login"),g.forEach(u)},m(n,p){w(n,o,p),b(o,r),w(n,a,p),w(n,s,p),b(s,_),f||(i=q(s,"click",le),f=!0)},p:F,d(n){n&&u(o),n&&u(a),n&&u(s),f=!1,i()}}}function pe(d){let o,r,a,s=d[4].name+"",_,f,i,n,p,g;return{c(){o=k("div"),r=k("h4"),a=S("Logged in as: "),_=S(s),f=W(),i=k("button"),n=S("Logout")},l(m){o=y(m,"DIV",{});var t=I(o);r=y(t,"H4",{});var h=I(r);a=A(h,"Logged in as: "),_=A(h,s),h.forEach(u),f=N(t),i=y(t,"BUTTON",{});var E=I(i);n=A(E,"Logout"),E.forEach(u),t.forEach(u)},m(m,t){w(m,o,t),b(o,r),b(r,a),b(r,_),b(o,f),b(o,i),b(i,n),p||(g=q(i,"click",ae),p=!0)},p(m,t){t&16&&s!==(s=m[4].name+"")&&V(_,s)},d(m){m&&u(o),p=!1,g()}}}function fe(d){let o,r,a,s,_,f,i,n,p,g,m,t,h,E,C,v=d[0].length>0&&d[4]&&z(d);function j(e,c){return e[4]?pe:de}let T=j(d),l=T(d);return{c(){o=k("a"),r=S("Run this program"),a=W(),s=k("input"),f=S(`
Apply Default Imports

`),v&&v.c(),i=W(),l.c(),n=W(),p=k("div"),g=k("div"),m=W(),t=k("script"),this.h()},l(e){o=y(e,"A",{href:!0});var c=I(o);r=A(c,"Run this program"),c.forEach(u),a=N(e),s=y(e,"INPUT",{type:!0,name:!0}),f=A(e,`
Apply Default Imports

`),v&&v.l(e),i=N(e),l.l(e),n=N(e),p=y(e,"DIV",{class:!0});var D=I(p);g=y(D,"DIV",{class:!0,id:!0}),I(g).forEach(u),D.forEach(u),m=N(e);const U=Y('[data-svelte="svelte-ct8fo5"]',document.head);t=y(U,"SCRIPT",{src:!0});var K=I(t);K.forEach(u),U.forEach(u),this.h()},h(){P(o,"href",te+"/run"),P(s,"type","checkbox"),P(s,"name","default includes"),s.checked=_=d[3].add_default_imports,P(g,"class","editor svelte-cmikal"),P(g,"id","editor"),P(p,"class","remainder svelte-cmikal"),t.async=!0,t.defer=!0,Z(t.src,h="https://apis.google.com/js/api.js")||P(t,"src",h)},m(e,c){w(e,o,c),b(o,r),w(e,a,c),w(e,s,c),w(e,f,c),v&&v.m(e,c),w(e,i,c),l.m(e,c),w(e,n,c),w(e,p,c),b(p,g),d[8](g),w(e,m,c),b(document.head,t),E||(C=q(s,"change",d[7]),E=!0)},p(e,[c]){c&8&&_!==(_=e[3].add_default_imports)&&(s.checked=_),e[0].length>0&&e[4]?v?v.p(e,c):(v=z(e),v.c(),v.m(i.parentNode,i)):v&&(v.d(1),v=null),T===(T=j(e))&&l?l.p(e,c):(l.d(1),l=T(e),l&&(l.c(),l.m(n.parentNode,n)))},i:F,o:F,d(e){e&&u(o),e&&u(a),e&&u(s),e&&u(f),v&&v.d(e),e&&u(i),l.d(e),e&&u(n),e&&u(p),d[8](null),e&&u(m),u(t),E=!1,C()}}}let L=!1;const me="https://www.googleapis.com/upload/drive/v3/files";function _e(d,o){var r=gapi.client.drive.files.get({fileId:d,alt:"media"});return r.then(function(a){console.log(a),typeof o=="function"&&o(a.body)},function(a){console.log(a)}),r}function ge(d,o,r){let a,s,_;R(d,B,l=>r(3,a=l)),R(d,M,l=>r(13,s=l)),R(d,O,l=>r(4,_=l));let f=!1,i="",n=null,p,g,m="";O.subscribe(l=>{l&&f&&i&&!L&&t()});const t=()=>{console.log("in reading file into editor",i),_e(i,l=>{M.set(l)})},h=()=>{r(2,m="(saving....)"),console.log("in save",i,s),E(i)};function E(l,e){return new Promise((c,D)=>{gapi.client.request({path:me+"/"+l,method:"PATCH",params:{uploadType:"media"},body:s}).then(U=>{c(console.log(U)),r(2,m="(saved!)")}).catch(U=>{D(console.log(U)),r(2,m="(error!)")})})}function C(){f||(console.log("lib loaded"),gapi.load("client:auth2",ce),gapi.load("client",function(){gapi.client.load("drive","v2",function(){console.log("drive loaded"),f=!0,f&&i&&!L?foo():console.log("gapi is ready but docid is not ready")})}))}let v=()=>{let l=!a.add_default_imports;B.set({...a,add_default_imports:l})};x(async()=>{self.MonacoEnvironment={getWorker(e,c){return c==="json"?new se:c==="css"||c==="scss"||c==="less"?new ie:c==="html"||c==="handlebars"||c==="razor"?new ne:c==="typescript"||c==="javascript"?new re:new oe}},g=await J(()=>import("../chunks/editor.main-7ea83a81.js").then(function(e){return e.e}),["chunks/editor.main-7ea83a81.js","assets/editor.main-fb5c4d06.css","chunks/preload-helper-60cab3ee.js"]),p=g.editor.create(n,{value:s,language:"python",fixedOverflowWidgets:!0}),p.onDidChangeModelContent(()=>{r(2,m="(unsaved)"),M.set(p.getValue())}),console.log("Mounted!"),f||C();const l=new URLSearchParams(window.location.search);return console.log(l.get("docid")),l.get("docid")?(r(0,i=l.get("docid")),B.set({...a,last_doc_id:i}),f&&i&&!L?t():console.log("docid is ready, but gapi is not ready")):a.last_doc_id.length>0&&(r(0,i=a.last_doc_id),f&&i&&!L?t():console.log("docid is ready, but gapi is not ready")),()=>{p.dispose()}});const j=()=>{v()};function T(l){$[l?"unshift":"push"](()=>{n=l,r(1,n)})}return[i,n,m,a,_,h,v,j,T]}class ke extends Q{constructor(o){super(),G(this,o,ge,fe,X,{})}}export{ke as default};
