import{S as I,i as R,s as z,e as h,t as P,k as g,c as w,a as y,h as S,d as r,m as E,b as v,g as d,J as b,E as k,v as C,L as D}from"../chunks/index-26a557cf.js";import{w as L,b as M}from"../chunks/paths-e19757bb.js";import{s as T}from"../chunks/codeSrc-5a58c592.js";const _=L(""),U=async n=>{console.log("loading prep");const a=fetch("vpython.zip").then(s=>s.arrayBuffer());let c=await loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/dev/full/",stdout:n||null,stderr:n||null});const p=await a;return console.log("Unpacking package"),c.unpackArchive(p,"zip"),console.log("Importing vpython package"),c},V=async()=>{let n,a;return window.__context={glowscript_container:$("#glowscript").removeAttr("id")},n=window.canvas,a=n(),a};function j(n){let a,c,p,s,f,i,l,m,u,e;return{c(){a=h("a"),c=P("Edit this code"),p=g(),s=h("h2"),f=P("Running...."),i=g(),l=h("div"),m=g(),u=h("div"),e=h("textarea"),this.h()},l(t){a=w(t,"A",{href:!0});var o=y(a);c=S(o,"Edit this code"),o.forEach(r),p=E(t),s=w(t,"H2",{});var x=y(s);f=S(x,"Running...."),x.forEach(r),i=E(t),l=w(t,"DIV",{id:!0,class:!0}),y(l).forEach(r),m=E(t),u=w(t,"DIV",{});var A=y(u);e=w(A,"TEXTAREA",{rows:!0,cols:!0}),y(e).forEach(r),A.forEach(r),this.h()},h(){v(a,"href",M+"/"),v(l,"id","glowscript"),v(l,"class","glowscript"),v(e,"rows","20"),v(e,"cols","80")},m(t,o){d(t,a,o),b(a,c),d(t,p,o),d(t,s,o),b(s,f),d(t,i,o),d(t,l,o),d(t,m,o),d(t,u,o),b(u,e),n[1](e)},p:k,i:k,o:k,d(t){t&&r(a),t&&r(p),t&&r(s),t&&r(i),t&&r(l),t&&r(m),t&&r(u),n[1](null)}}}function q(n,a,c){function p(e){_.update(t=>t+=e+`
`)}C(async()=>{l=await V(),s=await U(p),_.set(""),console.log("mounted",l,s),m()});let s=null,f,i,l;T.subscribe(e=>{f=e,console.log("src loaded")}),_.subscribe(e=>{console.log("stdout:",e),i&&c(0,i.value=e,i)});async function m(){try{if(s){let t=f.replace("rate(","await async_rate(");await s.loadPackagesFromImports(t);var e=await s.runPythonAsync(t);_.update(o=>o+=e)}}catch(t){console.log("Error:"+t),_.update(o=>o+="Error:"+t+`
`)}}function u(e){D[e?"unshift":"push"](()=>{i=e,c(0,i)})}return[i,u]}class H extends I{constructor(a){super(),R(this,a,q,j,z,{})}}export{H as default};
