import{S as P,i as I,s as O,e as m,t as S,k as g,c as _,a as y,h as A,d as i,m as E,b as h,g as d,J as b,E as k,v as T,L as j}from"../chunks/index-26a557cf.js";import{w as z,b as C}from"../chunks/paths-e19757bb.js";import{s as D}from"../chunks/codeSrc-adb860ce.js";const v=z(""),J=async r=>{console.log("loading prep");const a=fetch("vpython.zip").then(o=>o.arrayBuffer());let c=await loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/dev/full/",stdout:r||null,stderr:r||null});const p=await a;return console.log("Unpacking package"),c.unpackArchive(p,"zip"),console.log("Importing vpython package"),c},L=async()=>{let r,a;return window.__context={glowscript_container:$("#glowscript").removeAttr("id")},r=window.canvas,a=r(),a};function M(r){let a,c,p,o,f,n,l,w,u,e;return{c(){a=m("a"),c=S("Edit this code"),p=g(),o=m("h2"),f=S("Running...."),n=g(),l=m("div"),w=g(),u=m("div"),e=m("textarea"),this.h()},l(t){a=_(t,"A",{href:!0,target:!0});var s=y(a);c=A(s,"Edit this code"),s.forEach(i),p=E(t),o=_(t,"H2",{});var x=y(o);f=A(x,"Running...."),x.forEach(i),n=E(t),l=_(t,"DIV",{id:!0,class:!0}),y(l).forEach(i),w=E(t),u=_(t,"DIV",{});var R=y(u);e=_(R,"TEXTAREA",{rows:!0,cols:!0}),y(e).forEach(i),R.forEach(i),this.h()},h(){h(a,"href",C+"/"),h(a,"target","_self"),h(l,"id","glowscript"),h(l,"class","glowscript"),h(e,"rows","10"),h(e,"cols","80")},m(t,s){d(t,a,s),b(a,c),d(t,p,s),d(t,o,s),b(o,f),d(t,n,s),d(t,l,s),d(t,w,s),d(t,u,s),b(u,e),r[1](e)},p:k,i:k,o:k,d(t){t&&i(a),t&&i(p),t&&i(o),t&&i(n),t&&i(l),t&&i(w),t&&i(u),r[1](null)}}}function U(r,a,c){function p(e){v.update(t=>t+=e+`
`)}T(async()=>{l=await L(),o=await J(p),window.scene=l,window.__reportScriptError=e=>{p("REPORT ERROR:"+JSON.stringify(e))},v.set(""),w()});let o=null,f,n,l;D.subscribe(e=>{f=e}),v.subscribe(e=>{n&&c(0,n.value=e,n)});async function w(){try{if(o){let t=f.split("rate(").join("await async_rate(");await o.loadPackagesFromImports(t);var e=await o.runPythonAsync(t);e&&v.update(s=>s+=e)}}catch(t){console.log("Error:"+t),v.update(s=>s+="Error:"+t+`
`)}}function u(e){j[e?"unshift":"push"](()=>{n=e,c(0,n)})}return[n,u]}class F extends P{constructor(a){super(),I(this,a,U,M,O,{})}}export{F as default};
