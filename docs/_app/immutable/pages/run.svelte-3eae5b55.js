import{S as I,i as R,s as z,e as w,t as P,k as g,c as y,a as _,h as S,d as r,m as E,b as h,g as d,J as b,E as k,v as C,L as D}from"../chunks/index-26a557cf.js";import{w as L,b as M}from"../chunks/paths-e19757bb.js";import{s as T}from"../chunks/codeSrc-adb860ce.js";const v=L(""),U=async n=>{console.log("loading prep");const a=fetch("vpython.zip").then(s=>s.arrayBuffer());let c=await loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/dev/full/",stdout:n||null,stderr:n||null});const u=await a;return console.log("Unpacking package"),c.unpackArchive(u,"zip"),console.log("Importing vpython package"),c},V=async()=>{let n,a;return window.__context={glowscript_container:$("#glowscript").removeAttr("id")},n=window.canvas,a=n(),a};function j(n){let a,c,u,s,f,i,l,m,p,e;return{c(){a=w("a"),c=P("Edit this code"),u=g(),s=w("h2"),f=P("Running...."),i=g(),l=w("div"),m=g(),p=w("div"),e=w("textarea"),this.h()},l(t){a=y(t,"A",{href:!0,target:!0});var o=_(a);c=S(o,"Edit this code"),o.forEach(r),u=E(t),s=y(t,"H2",{});var x=_(s);f=S(x,"Running...."),x.forEach(r),i=E(t),l=y(t,"DIV",{id:!0,class:!0}),_(l).forEach(r),m=E(t),p=y(t,"DIV",{});var A=_(p);e=y(A,"TEXTAREA",{rows:!0,cols:!0}),_(e).forEach(r),A.forEach(r),this.h()},h(){h(a,"href",M+"/"),h(a,"target","_self"),h(l,"id","glowscript"),h(l,"class","glowscript"),h(e,"rows","10"),h(e,"cols","80")},m(t,o){d(t,a,o),b(a,c),d(t,u,o),d(t,s,o),b(s,f),d(t,i,o),d(t,l,o),d(t,m,o),d(t,p,o),b(p,e),n[1](e)},p:k,i:k,o:k,d(t){t&&r(a),t&&r(u),t&&r(s),t&&r(i),t&&r(l),t&&r(m),t&&r(p),n[1](null)}}}function q(n,a,c){function u(e){v.update(t=>t+=e+`
`)}C(async()=>{l=await V(),s=await U(u),window.scene=l,v.set(""),console.log("mounted",l,s),m()});let s=null,f,i,l;T.subscribe(e=>{f=e,console.log("src loaded")}),v.subscribe(e=>{console.log("stdout:",e),i&&c(0,i.value=e,i)});async function m(){try{if(s){let t=f.replace("rate(","await async_rate(");await s.loadPackagesFromImports(t);var e=await s.runPythonAsync(t);v.update(o=>o+=e)}}catch(t){console.log("Error:"+t),v.update(o=>o+="Error:"+t+`
`)}}function p(e){D[e?"unshift":"push"](()=>{i=e,c(0,i)})}return[i,p]}class H extends I{constructor(a){super(),R(this,a,q,j,z,{})}}export{H as default};
